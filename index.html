<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Book of Mormon Verse</title>
    <!-- React and ReactDOM libraries -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Basic styling for the body to center the content */
        body {
            font-family: 'Inter', sans-serif; /* Using Inter font */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            color: #333;
        }
        /* Container for the application content */
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            text-align: center;
            max-width: 600px;
            width: 90%;
            box-sizing: border-box; /* Include padding in width */
        }
        /* Styling for the main heading */
        h1 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 2em;
        }
        /* Styling for the verse content */
        .verse-content {
            font-size: 1.3em;
            margin-bottom: 20px;
            line-height: 1.7;
            color: #444;
            font-style: italic;
        }
        /* Styling for the verse reference */
        .verse-reference {
            font-size: 1em;
            font-weight: bold;
            color: #666;
            margin-top: 15px;
            margin-bottom: 30px;
        }
        /* Styling for the button */
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px; /* Rounded corners */
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        /* Hover effect for the button */
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        /* Disabled state for the button */
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        /* Styling for error messages */
        .error {
            color: #e74c3c;
            margin-top: 15px;
            font-weight: bold;
        }
        /* Styling for loading message */
        .loading {
            color: #7f8c8d;
            font-style: italic;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 1.7em;
            }
            .verse-content {
                font-size: 1.1em;
            }
            button {
                padding: 10px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- Root div where the React app will be mounted -->
    <div id="root"></div>

    <script type="text/babel">
        // API endpoint for fetching a random Book of Mormon verse.
        // The error message "Please specify a 'book' parameter (e.g., ?book=Ani_Ganth)"
        // indicates that the API expects a 'book' parameter.
        // Based on the example, the value for the book name might need to be capitalized
        // with underscores, matching the original user's input format for the book name.
        const API_URL = 'https://us-central1-ha-sefer-api.cloudfunctions.net/holybookApi/random_verse?book=Book_of_Mormon';

        /**
         * React functional component to fetch and display a random Book of Mormon verse.
         */
        function VerseFetcher() {
            // State variables for verse data, loading status, and error messages
            const [verse, setVerse] = React.useState(null);
            const [loading, setLoading] = React.useState(false);
            const [error, setError] = React.useState(null);

            /**
             * Asynchronously fetches a random verse from the API.
             * Handles loading states and error reporting.
             */
            const fetchVerse = async () => {
                setLoading(true); // Set loading to true while fetching
                setError(null);   // Clear any previous errors
                setVerse(null);   // Clear any previously displayed verse

                try {
                    const response = await fetch(API_URL); // Make the API call
                    // Check if the response was successful (status code 200-299)
                    if (!response.ok) {
                        // If response is not OK, try to read the response body for more details
                        const errorText = await response.text();
                        console.error("API Error Response Body:", errorText);
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json(); // Parse the JSON response
                    setVerse(data); // Set the fetched verse data to state
                } catch (e) {
                    // Catch and handle any errors during the fetch operation
                    setError("Failed to fetch verse. Please try again later.");
                    console.error("Error fetching verse:", e); // Log the error for debugging
                } finally {
                    setLoading(false); // Set loading to false once fetching is complete (success or failure)
                }
            };

            // useEffect hook to fetch a verse when the component mounts
            React.useEffect(() => {
                fetchVerse();
            }, []); // Empty dependency array ensures this runs only once on mount

            return (
                <div className="container">
                    <h1>Random Book of Mormon Verse</h1>
                    {/* Display loading message if data is being fetched */}
                    {loading && <p className="loading">Loading verse...</p>}
                    {/* Display error message if an error occurred */}
                    {error && <p className="error">{error}</p>}

                    {/* Display the verse if it has been successfully fetched */}
                    {verse && (
                        <div>
                            <p className="verse-content">{verse.Verse}</p>
                            <p className="verse-reference">{verse.Book} {verse.Chapter}:{verse.VerseNumber}</p>
                        </div>
                    )}

                    {/* Button to fetch another verse, disabled while loading */}
                    <button onClick={fetchVerse} disabled={loading}>
                        {loading ? 'Fetching...' : 'Get Another Verse'}
                    </button>
                </div>
            );
        }

        // Render the VerseFetcher component into the root div
        ReactDOM.render(<VerseFetcher />, document.getElementById('root'));
    </script>
</body>
</html>
